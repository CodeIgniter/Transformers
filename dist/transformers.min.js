/*! Transformers v1.3.0 | (c) Hex license */
!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define([],b):a.TF=b()}(this,function(){"use strict";var a,b;b=a=b||{version:"1.3.0",build:"20141105"};var c=$.proxy,d=$.extend,e=function(a,b,c){var d;if("function"==typeof c)for(d in b)a[d]=c(a[d],b[d],d);else for(d in b)(c||!(a[d]||d in a))&&(a[d]=b[d]);return a},f=function(a,b){var c=a.split("."),d=0,e;for(b=b||window;e=c[d++];)b[e]||(b[e]={}),b=b[e];return b},g=function(a,b){return new Function("opts","return ("+a+");")(b)},h=function(a){return a.slice(0,1).toUpperCase()+a.slice(1)},i=function(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})},j=function(a){if(!a)return{};for(var b=decodeURI(a),c=b.replace(/\+/g," ").split("&"),d={},e,f,g=0,h=c.length;h>g;g++)e=c[g].split("="),f=e[0],void 0===d[f]?d[f]=unescape(e[1]):("string"==typeof d[f]&&(d[f]=[d[f]]),d[f].push(unescape(e[1])));return d},k=function(a,b,c){a.__TFListeners||(a.__TFListeners={}),a.__TFListeners[b]||(a.__TFListeners[b]=$.Callbacks()),a.__TFListeners[b].add(c)},l=function(a,b,c){a.__TFListeners&&a.__TFListeners[b]&&(c?a.__TFListeners[b].remove(c):a.__TFListeners[b].empty())},m=function(a,b,c){c.__TFListeners&&c.__TFListeners[a]&&c.__TFListeners[a].fireWith(c,$.makeArray(b))};f("Core",a),f("Component",a),f("Config",a),f("Library",a),f("Helper",a);var n={baseUrl:"/",resourceVersion:"ver",templateUriPattern:'{$name.join("-")}-view.html',jsUriPattern:'resource/js/{$name.join("-")}.js?v={$ver}',dataUriPattern:'data-{$name.join("-")}-{$uri}.js',defaultDataUri:"model",debug:!1,mentor:{}},o={};o.Status=function(){var b=$.isFunction,c=a.Config,d={unsetStatusMsg:function(a){var d=c[a].mentor;d.Status&&b(d.Status.unsetStatusMsg)&&d.Status.unsetStatusMsg.apply(d.Status,[].slice.call(arguments,1))},setSuccMsg:function(a){var d=c[a].mentor;d.Status&&b(d.Status.setSuccMsg)&&d.Status.setSuccMsg.apply(d.Status,[].slice.call(arguments,1))},setFailMsg:function(a){c[a]||(a=s);var d=c[a].mentor;d.Status&&b(d.Status.setFailMsg)&&d.Status.setFailMsg.apply(d.Status,[].slice.call(arguments,1))},setWarningMsg:function(a){var d=c[a].mentor;d.Status&&b(d.Status.setWarningMsg)&&d.Status.setWarningMsg.apply(d.Status,[].slice.call(arguments,1))},setLoadingMsg:function(a){var d=c[a].mentor;d.Status&&b(d.Status.setLoadingMsg)&&d.Status.setLoadingMsg.apply(d.Status,[].slice.call(arguments,1))},unsetLoadingMsg:function(a){var d=c[a].mentor;d.Status&&b(d.Status.unsetLoadingMsg)&&d.Status.unsetLoadingMsg.apply(d.Status,[].slice.call(arguments,1))}};return d}(),o.Template=function(){var b=$.isFunction,c={render:function(c,d,e){var f=a.Config[c].mentor;return f.Template&&b(f.Template.render)?f.Template.render.apply(f.Template,[].slice.call(arguments,1)):a.Helper.Utility.template(d,e)}};return c}(),o.Ajax=function(){var b=$.isFunction,c={validation:function(c,d){var e=a.Config[c].mentor;return e.Ajax&&b(e.Ajax.validation)?e.Ajax.validation.apply(e.Ajax,[].slice.call(arguments,1)):!0}};return c}(),o.Form=function(){var b=$.isFunction,c={validation:function(c,d){var e=a.Config[c].mentor;return e.Form&&b(e.Form.validation)?e.Form.validation.apply(e.Form,[].slice.call(arguments,1)):!0}};return c}(),a.Helper.Browser=function(){var a=window.navigator,b=a.userAgent.toLowerCase(),c=/(msie|webkit|gecko|presto|opera|safari|firefox|chrome|maxthon|android|ipad|iphone|webos|hpwos)[ \/os]*([\d_.]+)/gi,d={platform:a.platform};if(b.replace(c,function(a,b,c){var e=b.toLowerCase();d[e]||(d[e]=c)}),d.opera&&b.replace(/opera.*version\/([\d.]+)/,function(a,b){d.opera=b}),d.msie){d.ie=d.msie;var e=parseInt(d.msie,10);d["ie"+e]=!0;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(f){}}return d}(),a.Helper.Utility={baseUrl:function(b){return b=b||s,a.Config[b].baseUrl},siteUrl:function(b,c){return b=b||s,0===c.indexOf("http://")?c:a.Config[b].baseUrl+c},getApplicationName:function(a){var b;return b=a.indexOf(":")>0?a.split(":")[0]:s,h(b)},getComponentUrl:function(b,c,d){var e=a.Config[b],f=e.dataUriPattern,g=a.Helper.Utility.splitComponentName(d),h=this.template(f,{name:g,uri:c});return e.baseUrl+h},getComponentViewUrl:function(b,c){var d=a.Config[b],e=d.templateUriPattern,f=a.Helper.Utility.splitComponentName(c),g=this.template(e,{name:f});return d.baseUrl+g},getComponentJsUrl:function(b,c){var d=a.Config[b],e=d.jsUriPattern,f=a.Helper.Utility.splitComponentName(c),g=this.template(e,{name:f,ver:d.resourceVersion});return d.baseUrl+g},getDefaultDataUri:function(b){return a.Config[b].defaultDataUri},random:function(){return(new Date).getTime()+Math.floor(9999*Math.random())},toComponentName:function(a){var b,c,d;return a.indexOf(":")>0?(d=a.split(":"),b=d[0],c=d[1],h(b)+":"+h($.camelCase(c))):h($.camelCase(a))},toComponentUriName:function(a,b){var c,d,e="";return b=b||"-",a.indexOf(":")>0&&(d=a.split(":"),c=d[0],a=d[1],e=c.toLowerCase()+":"),e+=a.replace(/[A-Z]/g,function(a){return b+a.toLowerCase()}).slice(1)},splitComponentName:function(a){var b=[];return a.replace(/([A-Z][a-z]*)/g,function(a){b.push(a.toLowerCase())}),b},getComponentName:function(a){return a.indexOf(":")>0&&(a=a.split(":")[1]),a},getFullComponentName:function(b){return a.Helper.Utility.getApplicationName(b)+":"+a.Helper.Utility.getComponentName(b)},template:function(){var a="sArrCMX",b=a+'.push("',c={js:{tagG:"js",isBgn:1,isEnd:1,sBgn:'");',sEnd:";"+b},"if":{tagG:"if",isBgn:1,rlt:1,sBgn:'");if',sEnd:"{"+b},elseif:{tagG:"if",cond:1,rlt:1,sBgn:'");} else if',sEnd:"{"+b},"else":{tagG:"if",cond:1,rlt:2,sEnd:'");}else{'+b},"/if":{tagG:"if",isEnd:1,sEnd:'");}'+b},"for":{tagG:"for",isBgn:1,rlt:1,sBgn:'");for',sEnd:"{"+b},"/for":{tagG:"for",isEnd:1,sEnd:'");}'+b},"while":{tagG:"while",isBgn:1,rlt:1,sBgn:'");while',sEnd:"{"+b},"/while":{tagG:"while",isEnd:1,sEnd:'");}'+b}};return function(d,e){for(var f=-1,g=[],h=[[/\{strip\}([\s\S]*?)\{\/strip\}/g,function(a,b){return b.replace(/[\r\n]\s*\}/g," }").replace(/[\r\n]\s*/g,"")}],[/\\/g,"\\\\"],[/"/g,'\\"'],[/\r/g,"\\r"],[/\n/g,"\\n"],[/\{[\s\S]*?\S\}/g,function(a){var b;a=a.substr(1,a.length-2);for(var d=0;d<i.length;d++)a=a.replace(i[d][0],i[d][1]);var e=a;/^(.\w+)\W/.test(e)&&(e=RegExp.$1);var h=c[e];if(h){if(h.isBgn&&(b=g[++f]={tagG:h.tagG,rlt:h.rlt}),h.isEnd){if(0>f)throw new Error("Unexpected Tag: "+a);if(b=g[f--],b.tagG!=h.tagG)throw new Error("Unmatch Tags: "+b.tagG+"--"+e)}else if(!h.isBgn){if(0>f)throw new Error("Unexpected Tag:"+a);if(b=g[f],b.tagG!=h.tagG)throw new Error("Unmatch Tags: "+b.tagG+"--"+e);if(h.cond&&!(h.cond&b.rlt))throw new Error("Unexpected Tag: "+e);b.rlt=h.rlt}return(h.sBgn||"")+a.substr(e.length)+(h.sEnd||"")}return'",('+a+'),"'}]],i=[[/\\n/g,"\n"],[/\\r/g,"\r"],[/\\"/g,'"'],[/\\\\/g,"\\"],[/\$(\w+)/g,'opts["$1"]'],[/print\(/g,a+".push("]],j=0;j<h.length;j++)d=d.replace(h[j][0],h[j][1]);if(f>=0)throw new Error("Lose end Tag: "+g[f].tagG);d=d.replace(/##7b/g,"{").replace(/##7d/g,"}").replace(/##23/g,"#"),d="var "+a+"=[];"+b+d+'");return '+a+'.join("");';var k=new Function("opts",d);return arguments.length>1?k(e):k}}()},a.Library.Hash=function(a){return this.data=a||{},this},e(a.Library.Hash.prototype,{has:function(a){return void 0!=this.data[a]},keyOf:function(a){for(var b in this.data)if(this.data.hasOwnProperty(b)&&this.data[b]===a)return b;return null},hasValue:function(a){return null!==this.keyOf(a)},each:function(a){return $.each(this.data,a),this},combine:function(a,b){return e(this.data,a||{},b),this},erase:function(a){return this.data.hasOwnProperty(a)&&delete this.data[a],this},get:function(a){return this.data.hasOwnProperty(a)?this.data[a]:null},set:function(a,b){return(!this.data[a]||this.data.hasOwnProperty(a))&&(this.data[a]=b),this},empty:function(){var a=this;return $.each(this.data,function(b,c){delete a.data[b]}),this},include:function(a,b){return void 0!=this.data[a]&&(this.data[a]=b),this},getKeys:function(){var a=[];return $.each(this.data,function(b){a.push(b)}),a},getValues:function(){var a=[];return $.each(this.data,function(b,c){a.push(c)}),a},toQueryString:function(){var a=[];for(var b in this.data)if(null!=this.data[b])if(this.data[b]instanceof Array)for(var c=0;c<this.data[b].length;c++)a.push(encodeURIComponent(b)+"[]="+encodeURIComponent(this.data[b][c]));else a.push(encodeURIComponent(b)+"="+encodeURIComponent(this.data[b]));return a.join("&")}}),a.Library.LocationHash=function(b){return this.options={blank_page:"javascript:0",start:!1},this.prefix="#",this.iframe=null,this.handle=!1,this.useIframe=a.Helper.Browser.ie&&("undefined"==typeof document.documentMode||document.documentMode<8),this.state=null,this.supports="onhashchange"in window&&("undefined"==typeof document.documentMode||document.documentMode>7),this.noFireOnce=!1,e(this.options,b,!0),this.initialize(),this},e(a.Library.LocationHash.prototype,{initialize:function(){var b=this;a.Helper.Browser.opera&&window.history.navigationMode&&(window.history.navigationMode="compatible"),this.supports?$(window).on("hashchange",function(){return b.noFireOnce?void(b.noFireOnce=!1):void m("hashChanged",{hash:b.getHash()},b)}):this.useIframe&&this.initializeHistoryIframe(),this.options.start&&this.start()},initializeHistoryIframe:function(){var a=this.getHash(),b;this.iframe=this.getIframe(),this.istate=null,b=this.iframe.contentDocument?this.iframe.contentDocument:this.iframe.contentWindow.document,b.open(),b.write("<html><head><title>"+document.title+'</title></head><body id="state">'+a+"</body></html>"),b.close(),this.istateOld=!1},checkHash:function(){var b=this.getState();this.state!=b&&(a.Helper.Browser.ie&&null!==this.state?this.setState(b,!0):this.state=b,m("hashChanged",{hash:b},this))},getHash:function(){var a=decodeURI(top.location.href),b=a.indexOf(this.prefix)+1;return b?a.substr(b):""},setHash:function(a,b){if(this.getHash()!=a){if(a=encodeURI(a),this.supports)return b&&(this.noFireOnce=!0),void(top.location.hash=this.prefix+a||this.prefix);this.setState(a),b||m("hashChanged",{hash:a},this)}},pick:function(){for(var a=0,b=arguments.length;b>a;a++)if(void 0!=arguments[a])return arguments[a];return null},getState:function(){var a=this.getHash();if(this.iframe){var b=this.iframe.contentWindow.document;if(!b||"state"!=b.body.id)return this.istate;var c=decodeURI(b.body.innerText);if(this.state==a)return c;this.istateOld=!0}return a},setState:function(b,c){if(b=this.pick(b,""),top.location.hash=this.prefix+b||this.prefix,a.Helper.Browser.ie&&(!c||this.istateOld)){this.iframe||(this.iframe=this.getIframe(),this.istate=this.state);var d=this.iframe.contentDocument?this.iframe.contentDocumnet:this.iframe.contentWindow.document;d.open(),d.write("<html><head><title>"+document.title+'</title></head><body id="state">'+b+"</body></html>"),d.close(),this.istateOld=!1}this.state=b},clear:function(a){return clearTimeout(a),clearInterval(a),null},start:function(){return this.supports?void m("hashChanged",{hash:this.getHash()},this):(this.handle=setInterval(c(this.checkHash,this),200),this.started=!0,this)},stop:function(){this.clear(this.handle)},getIframe:function(){return $('<iframe src="'+this.options.blank_page+'"></iframe>').css({position:"absolute",top:0,left:0,width:"1px",height:"1px",visibility:"hidden"}).appendTo(document.body)[0]}}),a.Library.ComponentLoader=function(b,c){return this.options={name:"Default",url:"",hide:!1,lazyInit:!1,lazyRender:!1,appendRender:!1,replaceRender:!1,renderTo:"#component",applyTo:"",contentEl:"",data:""},e(this.options,b,!0),this.componentMgrInstance=c?c:a.Core.ComponentMgr,this.initialize(),this},e(a.Library.ComponentLoader.prototype,{initialize:function(){this._instance=null,this._instanced=!1,this.fullName=this.options.name,this.appName=a.Helper.Utility.getApplicationName(this.options.name),this.name=a.Helper.Utility.getComponentName(this.options.name)},on:function(a,b){return k(this,a,b)},load:function(){this._preload()},_preload:function(){var b=this;a.Component[this.appName]=a.Component[this.appName]||{};var c="undefined"!=typeof a.Component[this.appName][this.name];c?this._createInstance():$.getScript(a.Helper.Utility.getComponentJsUrl(this.appName,this.name)).done(function(){"undefined"!=typeof a.Component[b.appName][b.name]?b._createInstance():b._failure()}).fail(function(a,c,d){console&&console.error(d.message),b._failure()})},_createInstance:function(){try{this._instance=new a.Component[this.appName][this.name](this.options)}catch(b){}this._instance||this._failure(),this._funcs=[],this._loadMentor(c(this._initInstance,this))},_loadMentor:function(b,c,d){var e,f=this,g,h;if(c){g=a.Helper.Utility.getApplicationName(c),h=a.Helper.Utility.getComponentName(c);var i="undefined"!=typeof a.Component[g][h];i?(e=a.Component[g][h].prototype.Mentor,e&&e.name?f._loadMentor(function(){f._initMentor(c,d,a.Component[g][h]),b()},e.name,a.Component[g][h]):(f._initMentor(c,d,a.Component[g][h]),b())):$.getScript(a.Helper.Utility.getComponentJsUrl(g,h),function(){"undefined"!=typeof a.Component[g][h]&&(e=a.Component[g][h].prototype.Mentor,e&&e.name?f._loadMentor(function(){f._initMentor(c,d,a.Component[g][h]),b()},e.name,a.Component[g][h]):(f._initMentor(h,d,a.Component[g][h]),b()))})}else this._instance.Mentor?this._loadMentor(b,this._instance.Mentor.name):b()},_initMentor:function(b,c,d){var f,g,h=d.prototype;c=c||this._instance,$.isFunction(c)?(f=c.prototype,g=c.prototype):(f=this._instance,g=a.Component[this.appName][this.name].prototype),e(f,h,function(a,b,c){return"Mentor"==c||g.hasOwnProperty(c)?$.isFunction(b)&&$.isFunction(a)&&/\b_super\b/.test(a)?function(a,b){return function(){var c=this._super;this._super=h[a];var d=b.apply(this,arguments);return this._super=c,d}}(c,a):a:b}),$.isFunction(c)?(f.Mentor.useMentorView?(f.Mentor.useMentorView=!1,f.Mentor.useView=b):f.Mentor.useView&&(f.Mentor.useView=h.Mentor.useView),h.Mentor?(e(f.Mentor.viewData,h.Mentor.viewData,!0),f.Mentor.__path=h.Mentor.__path?h.Mentor.__path:[]):f.Mentor.__path=[],f.Mentor.__path.push(b)):(this._instance.Mentor.useMentorView?this._instance.sys.viewName=h.Mentor&&h.Mentor.useView?h.Mentor.useView:b:this._instance.Mentor.useView&&(this._instance.sys.viewName=this._instance.Mentor.useView),h.Mentor&&h.Mentor.__path?(this._instance.Mentor.__path=h.Mentor.__path,this._instance.Mentor.__path.push(b)):this._instance.Mentor.__path=[b],this._instance.sys.options.data=this._instance.sys.options.data||{},e(this._instance.sys.options.data,this._instance.Mentor.viewData,!0))},_initInstance:function(a){this._instanced=!0,e(this._instance.sys.options,this.options,function(a,b,c){return"data"==c?$.isPlainObject(b)?(a||(a={}),e(a,b,!0)):"string"==$.type(b)?(a||(a={}),e(a,j(b),!0)):a:b}),this._instance.sys.hidden=this.options.hide,this._instance.sys.fullName=this.fullName,this._instance.sys.appName=this.appName,this._instance.sys.name=this.name,this._instance.sys.index=this.options.__index||0,this._instance.sys.contentElement=this.options.__element,delete this._instance.options.__element,delete this._instance.sys.options.__element,this._instance.sys.parentComponentMgr=this.componentMgrInstance,this._instance.InstanceReady(this);var b={instance:this._instance,fullName:this.fullName,name:this.name,appName:this.appName};m("instanced",b,this),this.options.lazyRender||this._instance.sys.render(),m("complete",b,this)},_failure:function(){m("failure",{instance:null,fullName:this.fullName,name:this.name,appName:this.appName},this)},getInstance:function(){return this._instance},cancel:function(){this._instance&&this._instance.sys.cancelRender()}});var p={postMessage:function(a,b){var c;if(!this.rendered){switch(a){case"component-show":this.hidden=!1;break;case"component-only-show":this.hidden=!1;break;case"component-hide":this.hidden=!0}return"component-route"==a?this.lastRouterMessage={msg:a,args:b}:this.lastMessage={msg:a,args:b},void(this.rendering||this.render())}var d=!0,e=$.camelCase(a),f=b;switch(a){case"component-route":f=this._filterRouterArgs(b)}if(this.instance&&$.isFunction(this.instance[e+"ActionBefore"])&&(d=this.instance[e+"ActionBefore"].call(this.instance,f,b)),d!==!1){switch(a){case"component-route":this.route(b);break;case"component-render":this.render(b);break;case"component-refresh":this.refresh(b);break;case"component-destroy":this.destroy(b);break;case"component-show":this.show(b);break;case"component-only-show":this.onlyShow(b);break;case"component-hide":this.hide(b)}return this.instance&&$.isFunction(this.instance[e+"Action"])&&(c=this.instance[e+"Action"].call(this.instance,f,b)),this.parentComponentMgr.publish(this.name+"["+this.index+"]",a,b),c}},route:function(b){var c=!1;if(a.Helper.Utility.getFullComponentName(a.Core.Router.parseUri().name)==a.Helper.Utility.getFullComponentName(this.fullName)&&this.postMessage("component-only-show"),"normal"==this.layoutType)this.layoutData.page=b?this.getUriPage(b):0,this.renderNormalLayout(!1,null,c);else if("tab"==this.layoutType){if(b){var d=this.layoutData.tabs.get(this.getUriTab(b))||0;this.layoutData.items[d].page=this.getUriPage(b),this.layoutData.tab.switchTo(d)}else this.layoutData.items[0].page=0,this.layoutData.tab.switchTo(0);this.renderTabLayout(!1,null,c)}},_filterRouterArgs:function(a){var b;if("normal"==this.layoutType)return b=a[a.length-1]||"",/p\d+/.test(b)?a.slice(0,-1):a.slice(0);if("tab"==this.layoutType){var c;b=a[a.length-1]||"",c=/p\d+/.test(b)?a.slice(0,-1):a.slice(0);var d=c[0]||"";return c.slice(/tab-.+/.test(d)?1:0)}return a},render:function(){this.rendering||(this.rendering=!0,this.instance&&!this.rendered&&(this.options.applyTo?this._loadComplete($(this.options.applyTo)):this.options.contentEl?this._loadComplete($(this.options.contentEl).clone()):this._loadContent()))},refresh:function(a){this.rendered&&($.isPlainObject(a)&&(this.options.data=a,this.loader.data=a),this.refreshing=!0,this._loadContent())},_loadContent:function(){""==this.options.url?this.options.url=this.viewName?a.Helper.Utility.getComponentViewUrl(a.Helper.Utility.getApplicationName(this.viewName),a.Helper.Utility.getComponentName(this.viewName)):a.Helper.Utility.getComponentViewUrl(this.appName,this.name):this.options.url.indexOf("http://")<0&&(this.options.url=a.Helper.Utility.siteUrl(this.appName,this.options.url)),this.options.hasCache||(this.options.data=this.options.data||{},$.isString(this.options.data)&&(this.options.data=j(this.options.data)),this.options.data._reqno=a.Helper.Utility.random()),this.loader=$.ajax(this.options.url,{data:this.options.data||"",type:"GET",timeout:1e4,dataType:"text",xhrFields:{withCredentials:!0},success:c(this._loadComplete,this),error:c(function(){},this)})},_loadComplete:function(b,d,e){var f=this;if((!e||"abort"!=e.statusText)&&this.instance){var g,h;if(g=b,"string"==$.type(g))a.Helper.Browser.ie&&(g=g.replace(/(<div\s+class="TFComponent"\s*>)/gi,'$1<div style="display:none">tf</div>')),h=$("<div></div>").html(g).find(".TFComponent");else{if(!(g&&g.length>0))return;h=g.first()}if(0==h.length)return void(g&&this._loadError("DEBUG: "+g));var i=h;this.refreshing?this.topElement.html(i.html()):this._setTopElement(i),this.hidden&&this.topElement.hide();var j=$(this.options.renderTo);if(!this.refreshing&&!this.options.applyTo)if(this.options.appendRender||this.options.replaceRender||j.empty(),this.options.replaceRender){var k=j[0].attributes.getNamedItem("class");k&&$.each(k.value.split(" "),function(a,b){i.addClass(b)});var l=j[0].attributes.getNamedItem("style");if(l){var n=document.createAttribute("style");n.value=l.value,i[0].attributes.setNamedItem(n)}j.replaceWith(i)}else j.append(i);if(0==this.find(".tf-component-error").length){this.find().attr("data-tf-component",this.fullName);var p=this.find("script.TFTemplate"),q=this.find("script.TFData"),r=null;if(q.length>0)try{r=$.parseJSON(q.html())}catch(s){}r&&p.length>0&&this.find().html(o.Template.render(this.appName,p.html(),{ComponentData:r})),this.instance.options.TFData=r;var t=this.find(".tf-options"),u,v;$.each(t,function(a,b){b=$(b),u=b.attr("name"),u&&(v=b.prop("tagName").toLowerCase(),f.instance.options[u]="input"==v||"textarea"==v?b.val():b.html())}),m("complete",this._getEventObject(),this.instance),this.refreshing?(this._setDefaultSubmit(),this._loadSubComponents(c(function(){this.instance.DomRefreshReady(),this._setDefaultFocus(),this.rendering=!1,this.refreshing=!1,m("refreshReady",this._getEventObject(),this.instance)},this))):(this._delegateJsEvent(),this._delegateJsAction(),this._delegateEvent(this.instance.Events),this._setDefaultSubmit(),this._loadSubComponents(c(function(){this.instance.DomReady(),this._setDefaultFocus(),this.rendered=!0,this.rendering=!1,this.refreshing=!1,this.lastRouterMessage&&(this.postMessage(this.lastRouterMessage.msg,this.lastRouterMessage.args),this.lastRouterMessage=null),this.lastMessage&&(this.postMessage(this.lastMessage.msg,this.lastMessage.args),this.lastMessage=null),m("ready",this._getEventObject(),this.instance)},this)))}else this.rendering=!1,this.refreshing=!1,m("failure",this._getEventObject(),this.instance),a.Config[this.appName].debug&&console&&console.error("Component ["+this.getComponentName()+"] load error!"),this.instance.LoadError();return!0}},_getEventObject:function(){return{instance:this.instance,fullName:this.fullName,name:this.name,appName:this.appName}},_loadError:function(a){console&&console.error(a)},_delegateEvent:function(a){if(a){var b,c=this,d=function(a){var d=b[a];return"string"==$.type(d)&&(d=c.instance[d]),function(a){return a.stopPropagation(),d.call(c.instance,a,this)}};for(var e in a){b=a[e],$.isFunction(b)&&(b={click:b});for(var f in b)this.topElement.delegate(e,f,d(f))}}},_getBindingData:function(a){var b=$(a),c=b.hasClass("tf-bind")?b:b.parents(".tf-bind"),d={},e="",f,h="",i=this;if(c.length>0){if(f=b.parents("[class*=TFTarget]"),f.length>0){var j=/TFTarget-(\S+)/.exec(f.attr("class"));j&&(h=j[1]),h&&(h='["'+h+'"]')}e=c.data("bind")||"null",e=e.split(","),e.length>1?(d=[],$.each(e,function(a,b){d.push(g("opts"+h+"."+$.trim(b),i.templateData))})):d=g("opts"+h+"."+$.trim(e[0]),this.templateData)}return d},_delegateJsAction:function(){var a=this;this.topElement.delegate("[tf-action-click]","click",function(b){b.stopPropagation(),"a"==this.tagName.toLowerCase()&&b.preventDefault();var c={},d=$(this).attr("tf-action-click")||"",e=/(.*?)\((.*)\)/.exec(d);e&&(d=$.trim(e[1]),""!=e[2]&&(c=g(e[2]))),$.isPlainObject(c)&&(c.__event=b,c.__data=a._getBindingData(this)),a.postMessage(d,c)})},_delegateJsEvent:function(){var a=this;this.topElement.delegate("[tf-event-click]","click",function(b){if(b.stopPropagation(),"a"==this.tagName.toLowerCase()&&b.preventDefault(),"label"!=b.target.tagName.toLowerCase()){b.__data=a._getBindingData(this);var c=$.camelCase($(this).attr("tf-event-click"));return a.instance&&$.isFunction(a.instance[c+"Event"])?a.instance[c+"Event"].call(a.instance,b,this):void 0}}),this.topElement.delegate("[tf-event-change]","change",function(b){b.stopPropagation(),b.__data=a._getBindingData(this);var c=$(this).attr("tf-event-change");return c&&(c=$.camelCase(c),a.instance&&$.isFunction(a.instance[c+"Event"]))?a.instance[c+"Event"].call(a.instance,b,this):void 0})},_setDefaultSubmit:function(){var a=this.find("form.tf-button"),b;a.each(function(){b=$(this),b.length>0&&(b.off("submit"),b.on("submit",function(a){a.preventDefault()}),b.find("button.tf-default").attr("type","submit"))})},_setDefaultFocus:function(){if(!this.isHidden()){var a=this.find("form.tf-focus");if(a.length>0){for(var b=null,c,d,e=0,f=a[0].elements.length;f>e;e++){if(c=$(a[0].elements[e]),d=c.prop("tagName").toLowerCase(),"input"==d&&"hidden"!=c.attr("type")&&!c[0].readOnly&&c.is(":visible")){b=c;break}if("textarea"==d&&!c[0].readOnly&&c.is(":visible")){b=c;break}}b&&b.length>0&&(b.attr("autocomplete","off"),this.setFocus(b))}}},_loadSubComponents:function(b){var c=this;this.componentMgr=this.createComponentMgr(function(){c.instance.ComponentsReady(),b&&b()});var d=this.topElement.find(".tf-component"),e=this.topElement.find("*").filter(function(){return 0===this.tagName.toLowerCase().indexOf("tf:")});if(0==d.length&&0==e.length)return void(b&&b());var f,h,i,j=["id","class","style"],k;$.each(d,function(a,b){b=$(b),f={},h=b.attr("tf-component-name")||"",k=/(.*?)\((.*)\)/.exec(h),k&&(h=$.trim(k[1]),""!=k[2]&&(f=g(k[2]))),f.name=h,f.renderTo=b,c.componentMgr.add(f)});var l={};$.each(e,function(b,d){d=$(d),f={},h=a.Helper.Utility.toComponentName(d.prop("tagName").toLowerCase().slice(3)),"undefined"==typeof l[h]?l[h]=0:l[h]++;var e,g=null;d.children().length>0&&(e=document.createDocumentFragment(),e.appendChild($("<div></div>")[0]),g=e.childNodes[0],g.innerHTML=d.html()),i=$.makeArray(d[0].attributes),$.each(i,function(a,b){if($.inArray(b.name,j)<0)if(0===b.name.indexOf("data-view-"))f.data=f.data||{},f.data[b.name.substr(10)]=b.name==b.value||""===b.value?!0:b.value;else if(0===b.name.indexOf("tf-on-")){var d=$.camelCase(b.value);c.instance&&$.isFunction(c.instance[d])&&c.componentMgr.subscribe(h+"["+l[h]+"]",b.name.substr(6),function(){var a=h+"["+l[h]+"]";return function(b){this[d]({target:a,args:b})}}(),c.instance)}else f[$.camelCase(b.name)]=b.name==b.value||""===b.value?!0:b.value}),f.name=h,f.replaceRender=!0,f.renderTo=d,f.__element=g,c.componentMgr.add(f)}),this.componentMgr.startLoad(!0)},setFocus:function(a){return a?(a=$(a),void setTimeout(function(){try{a.length>0&&a[0].focus()}catch(b){}},200)):void this._setDefaultFocus()},createRouter:function(b,c,d){if(b){var e=b||[],f=c||function(){},g=d||this.instance,h=function(a){var b,c=!1;$.each(e,function(d,e){return $.each(e,function(h,i){h=h.replace(/:num/gi,"[0-9]+"),h=h.replace(/:any/gi,".*"),b=new RegExp("^"+h+"$"),a.match(b)&&(i.indexOf("$")>=0&&h.indexOf("(")>=0&&(i=a.replace(b,i)),c=!0,f.apply(g,[i,d,e]))}),c?!1:void 0}),c||f.apply(g,[a,-1,null])};a.Core.Application.subscribe("GlobalRoute",function(a){h(a)});var i=a.Core.Router.parseUri();h(i.uri)}},find:function(a){return this.topElement?a?this.topElement.find(a):this.topElement:$()},_setTopElement:function(b,c){if(c=c||"transformers_id",this.topElement=$(b).attr("id",c+"_"+a.Helper.Utility.random()).addClass("g-tf-"+a.Helper.Utility.toComponentUriName(this.fullName).replace(":","-")),this.instance.Mentor&&this.instance.Mentor.__path)for(var d=this.instance.Mentor.__path,e=d.length-1;e>=0;e--)this.topElement.addClass("g-tf-"+a.Helper.Utility.toComponentUriName(d[e]).replace(":","-"))},_unsetTopElement:function(){this.topElement&&this.topElement.length>0&&(this.topElement.parent().empty(),this.topElement=null)},getComponentName:function(){return this.name},setLoadingMsg:function(a){o.Status.setLoadingMsg(this.appName,a,this.instance)},unsetLoadingMsg:function(){o.Status.unsetLoadingMsg(this.appName,this.instance)},setSuccMsg:function(a){o.Status.setSuccMsg(this.appName,a,this.instance,{})},setFailMsg:function(a){o.Status.setFailMsg(this.appName,a,this.instance,{})},getUrl:function(b){return a.Helper.Utility.getComponentUrl(this.appName,b||"",this.name)},send:function(b,c){b=b.indexOf("/")<0?this.getUrl(b):a.Helper.Utility.siteUrl(this.appName,b.slice(1));var d={url:b,type:"GET",timeout:1e4,dataType:"text",xhrFields:{withCredentials:!0},context:{instance:this.instance},complete:this._sendComplete};if(c=c||{},$.isFunction(c.fn)&&(c.__TFCallback=c.fn,delete c.fn),e(d,c,!0),"object"==$.type(d.data)){var f=$(d.data),g=f.prop("tagName");g&&"form"==g.toLowerCase()&&(d.data=f.serialize())}d.hasCache||"GET"!=d.type||(d.data=d.data||{},$.isString(d.data)&&(d.data=j(d.data)),d.data._reqno=a.Helper.Utility.random());var h=b,i=this.sendRequester.get(h);return i&&i.abort(),d.context.options=d,i=$.ajax(d),this.sendRequester.set(h,i),c.loadingMsg!==!1&&this.setLoadingMsg(c.loadingMsg),i},_sendComplete:function(b){var c=this.instance;if(c.sys.sendRequester.erase(this.options.url),this.options.loadingMsg!==!1&&c.sys.unsetLoadingMsg(),"abort"!=b.statusText){var d=b.responseText,f=null;try{f=$.parseJSON(d)}catch(g){}if(f||(f="timeout"==b.statusText?{errno:998,errmsg:"Request timeout",data:[]}:{errno:999,errmsg:"Error!",data:[]}),a.Config[c.sys.appName].debug){var h=this.options.data&&("string"==$.type(this.options.data)?this.options.data:$.param(this.options.data));console&&console.debug("url: "+this.options.url+(h?"?"+h:""))}var i=!o.Ajax.validation(c.sys.appName,f),j;j=i?e(f,{message:f.errmsg,code:f.errno},!0):e(f,{message:"",code:0},!0),$.isFunction(this.options.__TFCallback)&&this.options.__TFCallback.call(c,!i,j),i?o.Status.setFailMsg(c.sys.appName,j.message,c,j):"string"==$.type(j.message)&&o.Status.setSuccMsg(c.sys.appName,j.message,c,j)}},renderStaticTemplate:function(b,c){var d,e=this;c=c||{},b=$.makeArray(b),$.each(b,function(b,f){if("string"==$.type(f))d=e.find(".TFTemplate-"+f).html(),e.find(".TFTarget-"+f).html(o.Template.render(e.appName,d,c)),e.templateData[f]=c;else if($.isPlainObject(f)){if(d=e.find(".TFTemplate-"+f.template).html(),"string"==$.type(f.target))e.find(".TFTarget-"+f.target).html(o.Template.render(e.appName,d,c));else{var g=$(f.target),h=/TFTarget-(\S+)/.exec(g.attr("class")),i;h?(i=h[1],$(f.target).html(o.Template.render(e.appName,d,c))):(i="gen-"+a.Helper.Utility.random(),$(f.target).addClass("TFTarget-"+i),$(f.target).html(o.Template.render(e.appName,d,c))),f.target=i}e.templateData[f.template]=c,e.templateData[f.target]=c}})},getRenderedTemplate:function(a,b){return o.Template.render(this.appName,this.find(".TFTemplate-"+a).html(),b||{})},renderTemplate:function(b,d,f){var g=this;if(b){d||(d={}),d.loadingMsg!==!1&&this.setLoadingMsg(d.loadingMsg);var h=this.getUrl(f||a.Helper.Utility.getDefaultDataUri(this.appName));b=$.makeArray(b),d&&d.data&&(d.old_data=d.data),d.fn?(d.old_fn=d.fn,d.fn=null,d.fn=function(a){g._pageInitialize(b,d),d.old_fn.call(g.instance,a),d.loadingMsg!==!1&&g.unsetLoadingMsg()}):d.fn=function(a){g._pageInitialize(b,d),d.loadingMsg!==!1&&g.unsetLoadingMsg()},d.page&&(d.pageData="component_page="+d.page),d.pageData&&($.isPlainObject(d.pageData)&&(d.pageData=$.param(d.pageData)),$.isPlainObject(d.old_data)&&(d.old_data=$.param(d.old_data)),d.data=d.old_data?d.old_data+"&"+d.pageData:d.pageData);var i=[],k=[],l=[],m=[];$.each(b,function(b,c){if("string"==$.type(c))i.push(g.find(".TFTemplate-"+c)),k.push(g.find(".TFTarget-"+c)),l.push(c),m.push(c);else if($.isPlainObject(c)){if(i.push(g.find(".TFTemplate-"+c.template)),"string"==$.type(c.target))k.push(g.find(".TFTarget-"+c.target));else{var d=$(c.target),e,f=/TFTarget-(\S+)/.exec(d.attr("class"));f?e=f[1]:(e="gen-"+a.Helper.Utility.random(),d.addClass("TFTarget-"+e)),c.target=e,k.push(d)}l.push(c.template),m.push(c.target)}}),e(d,{errorFunc:c(function(a){d.loadingMsg!==!1&&this.sys.unsetLoadingMsg(),this.RenderError(a)},g.instance)});var n,p=$.map(b,function(a){return $.isPlainObject(a)?$.param(a):a}),q={url:h,type:"GET",dataType:"text",xhrFields:{withCredentials:!0},complete:function(a,b){g.templateRequester.erase(p.join()),d.loadingMsg!==!1&&g.unsetLoadingMsg()},success:function(b,c,f){if(g.templateRequester.erase(p.join()),a.Config[g.appName].debug){var h=this.data&&("string"==$.type(this.data)?this.data:$.param(this.data));console&&console.debug("url: "+this.url+(h?"?"+h:""))}var j=b,q=null;try{q=$.parseJSON(j)}catch(r){}if(q&&$.isEmptyObject(q)&&(q=null),q&&"undefined"!=typeof d&&$.isFunction(d.filter)){var s=d.filter.call(g.instance,q);$.isPlainObject(s)&&e(q,s,!0)}q||(q={}),d.addition&&e(q,d.addition,!0),e(q,{__TF:{}},!0),o.Ajax.validation(g.appName,q)?($.each(i,function(a,b){q.__TF.template=l[a],q.__TF.target=m[a],n=$(k[a]);try{n.html(o.Template.render(g.appName,b.html(),q))}catch(c){n.html(c)}}),"undefined"!=typeof d&&$.isFunction(d.fn)&&d.fn(q)):"undefined"!=typeof d&&$.isFunction(d.errorFunc)?d.errorFunc(q):$.each(i,function(a,b){q.__TF.template=l[a],q.__TF.target=m[a],$(k[a]).html(q.toString()||"")}),$.each(i,function(a,b){g.templateData[l[a]]=q,g.templateData[m[a]]=q})}};e(q,d,!0),q.hasCache||"GET"!=q.type||(q.data=q.data||{},$.isString(q.data)&&(q.data=j(q.data)),q.data._reqno=a.Helper.Utility.random());var r=this.templateRequester.get(p.join());
r&&r.abort(),r=$.ajax(q),this.templateRequester.set(b.join(),r)}},_pageInitialize:function(a,b){var c,d=this;a=$.makeArray(a),$.each(a,function(e,f){"string"==$.type(f)?c=f:$.isPlainObject(f)&&(c=f.target),d.find(".TFTarget-"+c+" .ComponentPager").delegate("a","click",function(c){var f;c.stopPropagation(),c.preventDefault(),b.fn=null,b.fn=b.old_fn?b.old_fn:null,b.data=b.old_data?b.old_data:null,f=$(this).data("page"),d._pageHandler(a[e],f,b,e)})})},_pageHandler:function(b,c,d,e){if("string"==$.type(b)?d.pageData="component_template="+b:$.isPlainObject(b)&&(d.pageData="component_template="+b.template+"&component_target="+b.target),d.pageData+="&component_page="+c,d.page=c,this.renderTemplate(b,d),"normal"==this.layoutType?this.layoutData.page=c:"tab"==this.layoutType&&(this.layoutData.items[this.layoutData.tabs.get(b)].page=c),this.layoutType){var f=a.Core.Router.parseUri(),g=f.params;/p\d+/.test(g[g.length-1])?g[g.length-1]="p"+c:g[g.length]="p"+c,this.setRouterArgs(g,f.name)}},show:function(){this.hidden=!1,this.rendered&&(this.topElement.show(),this._setDefaultFocus())},onlyShow:function(){if(this.hidden=!1,this.rendered){var a=this.topElement,b,c,d=this;a.length>0&&(b=a.attr("id"),a.parent().find(".TFComponent").each(function(a,e){e=$(e),b!=e.attr("id")&&(c=e.data("tf-component"),c&&d.parentComponentMgr.post(c,"component-hide"))})),this.show()}},hide:function(){this.hidden=!0,this.rendered&&this.topElement.hide()},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},createComponentMgr:function(b){return a.Core.Application.createComponentMgrInstance(!1,c(b,this.instance))},cancelRequest:function(){this.sendRequester.each(function(a,b){b&&b.abort()})},cancelRender:function(){this.loader&&this.loader.abort()},destroy:function(){if(!this.instance||0!=this.instance.DomDestroy(this.instance)){this.parentComponentMgr.remove(this.fullName);try{this.cancelRender(),this.cancelRequest(),this._unsetTopElement(),this.instance=null}catch(a){}}},createNormalLayout:function(a){a&&(this.layoutType="normal",this.layoutData=a)},renderNormalLayout:function(a,b,c){if(a){var d=$.makeArray(b||[]);this.layoutData.page>0&&d.push("p"+this.layoutData.page),this.setRouterArgs(d)}c&&0!=this.find(".TFTarget-"+this.layoutData.name).children().length||this.layoutData.fn.call(this.instance,this.layoutData.page)},resetNormalLayoutPage:function(){this.layoutData.page=0},setNormalLayoutPage:function(a){this.layoutData.page=a||0},createTabLayout:function(b,c,d,e){var f=this;b&&(this.layoutType="tab",this.layoutData={tabs:new a.Library.Hash,items:b},$.each(b,function(a,b){f.layoutData.tabs.set(b.name,a)}),this.layoutData.tab=new QW.TabView(this.find(d||"")[0],e||{tabSelector:".le-tabs li",viewSelector:".views .view-item",selectedClass:"active",selectedViewClass:"active"}),this.layoutData.tab.switchToItem=function(b){var c=$.inArray(b,this.items),d=this.selectedIndex;this.switchTo(c),d!=c&&f.renderTabLayout(!0,a.Core.Router.parseUri().params,!0)},c&&this.layoutData.tab.switchTo(c))},renderTabLayout:function(a,b,c){var d=this.layoutData.tab.selectedIndex;if(a){var e=["tab-"+this.layoutData.items[d].name],f=$.makeArray(b||[]);/p\d+/.test(f[f.length-1])&&(f=f.slice(0,-1)),/tab-.+/.test(f[0])&&(f=f.slice(1)),e.push(f),this.layoutData.items[d].page>0&&e.push("p"+this.layoutData.items[d].page),this.setRouterArgs(e.expand(!0))}c&&0!=$(this.layoutData.tab.views[d]).find(".TFTarget-"+this.layoutData.items[d].name).children().length||this.layoutData.items[d].fn&&this.layoutData.items[d].fn.call(this.instance,this.layoutData.items[d].page)},resetTabLayoutPage:function(){var a=this.layoutData.tab.selectedIndex;this.layoutData.items[a].page=0},getCurrentTab:function(){var a=this.layoutData.tab.selectedIndex;return 0>a?$():$(this.layoutData.tab.views[a])},setRouterArgs:function(b,c){var d=[];d.push(a.Helper.Utility.toComponentUriName(c||this.fullName)),b=$.makeArray(b),b.length>0&&d.push(b.filter(function(a){return""!=a}).join("/")),this.lastArgs=b,a.Core.Router.setUri(d.join("/")),a.Core.Application.publish("GlobalRoute",[d.join("/"),[this.name,b]])},getUriPage:function(a){if(!a)return 0;a=$.makeArray(a);var b=a[a.length-1]||"";return/p\d+/.test(b)?b.slice(1):0},getUriTab:function(a){var b=this.layoutData.items[0].name;if(!a)return b;a=$.makeArray(a);var c=a[0]||"";return/tab-.+/.test(c)?c.slice(4):b},validate:function(a){var b=a?$(a):this.find("form.tf-validation");return b.length>0?o.Form.validation(this.appName,b):!0}};a.Component.Default=function(b){return this.options={},e(this.options,b,!0),this.sys={instance:this,options:{},name:"",rendered:!1,refreshing:!1,hidden:!1,sendRequester:new a.Library.Hash,templateRequester:new a.Library.Hash,templateData:{},index:0,lastArgs:[],contentElement:null},e(this.sys,p),this.initialize(b),this},e(a.Component.Default.prototype,{initialize:function(a){},InstanceReady:function(){},DomReady:function(){},DomRefreshReady:function(){},DomDestroy:function(){},ComponentsReady:function(){},LoadError:function(){a.Config[this.sys.appName].debug&&console&&console.error("Component ["+this.sys.getComponentName()+"] load error! Please refresh!")},RenderError:function(a){},on:function(a,b){return k(this,a,b)}});var q=!1,r=new a.Library.Hash,s="";a.Core.Application={create:function(b,c){var d="Transformers",f;"string"==$.type(b)?(d=b,f=c):f=b,a.Config[d]=e({},n,!0),e(a.Config[d],f,!0),s||(s=d)},isReady:function(){return q},subscribe:function(b,c,d){var e=a.Helper.Utility.random();return r.has(b)||r.set(b,new a.Library.Hash),r.get(b).set(e,{fn:c,scope:d}),{key:b,value:e}},unsubscribe:function(a){a&&r.has(a.key)&&r.get(a.key).erase(a.value)},publish:function(a,b){r.has(a)&&r.get(a).each(function(a,c){c.fn&&c.fn.apply(c.scope,b||[])})},bootstrap:function(b,c){b=$($(b).length>0?b:"body"),c=c||a.Core.ComponentMgr;var d=b.find("*").filter(function(a,b){return 0===b.tagName.toLowerCase().indexOf("tf:")});if(d.length>0){var e,f,g,h=["id","class","style"];d.each(function(b,d){d=$(d),e={},f=a.Helper.Utility.toComponentName(d.prop("tagName").toLowerCase().slice(3));var i,j=null;d.children().length>0&&(i=document.createDocumentFragment(),i.appendChild($("<div></div>")[0]),j=i.childNodes[0],j.innerHTML=d.html()),g=$.makeArray(d[0].attributes),$.each(g,function(a,b){$.inArray(b.name,h)<0&&(e[$.camelCase(b.name)]=b.name==b.value||""===b.value?!0:b.value)}),e.name=f,e.replaceRender=!0,e.renderTo=d,e.__element=j,c.add(e)})}c.startLoad()}};var t=function(b){var c=a.Component.Default,d=function(){c.apply(this,arguments);for(var a in d.prototype)d.prototype.hasOwnProperty(a)&&$.isPlainObject(d.prototype[a])&&(this[a]={},e(this[a],d.prototype[a],!0));"initialize"in this&&this.initialize.apply(this,arguments)};e(d.prototype,b);var f=function(){};f.prototype=c.prototype;var g=d.prototype;return d.prototype=new f,d.$super=c,e(d.prototype,g,!0),d};return a.Core.Application.createComponentMgrInstance=function(b,d){var f=0,g=0,h=0,j=new a.Library.Hash,l=new a.Library.Hash,m=new a.Library.Hash,n=new a.Library.Hash,o=!1,p=new a.Library.Hash,q=a.Helper.Utility.getFullComponentName,r=function(a){var b=q(a.fullName);null==a.instance&&$.error('Error: Component "'+b+'" load error! Please check Component Class Name or Define!');var c=j.get(b)[a.instance.options.__index||0];c.loaded=!0,c.instance=a.instance,g++,g>=f&&u()},s=function(a){r(a),h++},u=function(){b?a.Core.Application.publish("GlobalComponentLoaded"):$.isFunction(d)&&d()},v=function(a){a.instance&&!a.instance.options.lazyRender?k(a.instance,"ready",r):r(a)},w=function(b){r(b);var c=q(b.fullName);$.each(j.get(c).slice(1),function(b,c){c.options.__index=b+1;var d=new a.Library.ComponentLoader(c.options,z);k(d,"complete",r),k(d,"failure",r),d.load()})},x=function(b){b.instance&&!b.instance.options.lazyRender?k(b.instance,"ready",r):r(b);var c=q(b.fullName);$.each(j.get(c).slice(1),function(b,c){c.options.__index=b+1;var d=new a.Library.ComponentLoader(c.options,z);k(d,"complete",v),k(d,"failure",v),d.load()})},y=function(a){var b=/^([a-z0-9:]+)(?:\[([a-z0-9-_]+)\])?$/i.exec(a),c=0;if(!b)throw'Error: Component name "'+a+'" invalid!';if(a=b[1],c=b[2],void 0!==c&&isNaN(c)){if(!p.has(a+c))throw'Error: Component Alias "'+b[0]+'" not found!';c=p.get(a+c)}return{name:a,index:c}},z={create:function(a){return t(a)},startLoad:function(b){var c=this;o||(g=0,j.each(function(d,e){e[0].options.__index=0;var f=new a.Library.ComponentLoader(e[0].options,c);e.length>1?(k(f,"complete",b?x:w),k(f,"failure",b?x:w)):(k(f,"complete",b?v:r),k(f,"failure",b?v:s)),f.load()}))},isLoading:function(){return o},add:function(a,b){if(!o){a=$.makeArray(a),b=b||{};var c,d;return $.each(a,function(a,g){c="string"==$.type(g)?{name:g}:g,e(c,b),d=q(c.name),f++,j.has(d)?j.get(d).push({options:c,instance:null,loaded:!1}):j.set(d,[{options:c,instance:null,loaded:!1}]),c.alias&&(p.has(d+c.alias)&&$.error('Error: Component alias "'+d+"["+c.alias+']" duplicate definition!'),p.set(d+c.alias,j.get(d).length-1))}),this}},addToBg:function(a){return m.set(q(a.name),a),this},loadBgComponent:function(b){b=q(b);var d=m.get(b),e;if(!j.has(b)&&d){var f=c(function(a){e=n.get(b),e&&this.post(b,e[0],e[1])},this),g=new a.Library.ComponentLoader(d,this);k(g,"complete",f),g.load()}},remove:function(a){a=q(a);var b=y(a);if(void 0===b.index)j.erase(b.name);else{var c=j.get(b.name)[b.index];c&&(c.instance=null,c.loaded=!1)}},post:function(a,b,c){var d,e,f=this;a=$.makeArray(a),$.each(a,function(a,g){g=q(g),f.publish(g,b,c),d=y(g),void 0===d.index?(e=j.get(d.name),e&&$.each(e,function(a,d){d.loaded&&d.instance.sys.postMessage(b,c)})):(e=j.get(d.name)[d.index],e&&e.loaded&&e.instance.sys.postMessage(b,c))})},show:function(a){a=q(a),this.post(a,"component-only-show")},has:function(a){a=q(a);var b=y(a);return j.has(b.name)||m.has(b.name)},length:function(a){a=q(a);var b=y(a);return j.has(b.name)?j.get(b.name).length:0},subscribe:function(a,b,d,e){a=q(a);var f=y(a);a=f.name+(void 0===f.index?"":"["+f.index+"]");var g=c(d,e||d);return l.has(a+b)?l.get(a+b).push(g):l.set(a+b,[g]),{key:a+b,value:g}},unsubscribe:function(a){l.has(a.key)&&l.get(a.key).erase(a.value)},publish:function(a,b,c){a=q(a);var d=y(a),e=!1;a=d.name+(void 0===d.index?"":"["+d.index+"]");var f=j.get(d.name);void 0===d.index?f&&($.each(f,function(a,b){return b.loaded?(e=!0,!1):void 0}),e&&l.has(a+b)&&$.each(l.get(a+b),function(a,d){d.apply(d,[c,b])})):f&&f[d.index]&&f[d.index].loaded&&(l.has(a+b)&&$.each(l.get(a+b),function(a,d){d.apply(d,[c,b])}),l.has(d.name+b)&&$.each(l.get(d.name+b),function(a,d){d.apply(d,[c,b])}))},getAgent:function(a){a=q(a);var b=y(a),c,d,f,g,h;if(h=j.get(b.name),!h)return null;var k=function(a){return function(){return this.__instance.sys.postMessage(i(a),arguments[0])}};if(void 0===b.index)d=[],$.each(h,function(a,b){if(b.loaded){c={},e(c,{__instance:b.instance});for(var h in b.instance)$.isFunction(b.instance[h])&&(f=/^(.+?)Action$/.exec(h),f&&(g=$.trim(f[1]),c[g]=k(g)));d.push(c)}});else if(h[b.index]&&h[b.index].loaded){c=h[b.index].instance,d={},e(d,{__instance:c});for(var l in c)$.isFunction(c[l])&&(f=/^(.+?)Action$/.exec(l),f&&(g=$.trim(f[1]),d[g]=k(g)))}else d=null;return d}};return z},a.Core.ComponentMgr=a.Core.Application.createComponentMgrInstance(!0),a.Core.Router=function(){var b="Home",c=new a.Library.LocationHash,d=[],e=function(c){var d=c.match(/tf-([^\/]*)\/?(.*)/),e,f;return d?(e=d[1]?a.Helper.Utility.toComponentName(d[1]):b,f=d[2]?d[2].split("/"):[]):(e=b,f=[]),{name:e,params:f,uri:g.makeUri(e,f)}},f=function(b){var c=e(b),f=c.name,g=c.params,h=f;a.Core.ComponentMgr.has(h)?(a.Core.Application.publish("GlobalRoute",[c.uri,[f,g]]),a.Core.ComponentMgr.post(h,"component-route",g)):o.Status.setFailMsg(a.Helper.Utility.getApplicationName(h),a.Helper.Utility.toComponentUriName(f)+" uri error!");var i,j=!1;$.each(d,function(b,d){$.map(d,function(b,d){d=d.replace(/:num/gi,"[0-9]+"),d=d.replace(/:any/gi,".*"),i=new RegExp("^"+d+"$"),c.uri.match(i)&&(b.indexOf("$")>=0&&d.indexOf("(")>=0&&(b=c.uri.replace(i,b)),j=!0,a.Core.ComponentMgr.has(b)&&(a.Core.Application.publish("GlobalRoute",[c.uri,[f,g]]),a.Core.ComponentMgr.post(b,"component-route",g)))})})},g={create:function(e,g){d=g||d,b=e||b,a.Core.Application.subscribe("GlobalComponentLoaded",function(){k(c,"hashChanged",function(a){f(a.hash)}),c.start()})},parseUri:function(a){return e(a||c.getHash())},makeUri:function(b,c){b=b||"",c=c||[],b=a.Helper.Utility.toComponentUriName(b),c=c.join("/");var d=b;return c&&(d+="/"+decodeURI(c)),d},go:function(a,b,d){b?d&&location.pathname==b&&location.hash=="#tf-"+encodeURI(a)?location.reload():location.href=b+"#tf-"+encodeURI(a):c&&c.setHash("tf-"+a)},setUri:function(a){c&&c.setHash("tf-"+a,!0)},getUri:function(a){return"tf-"+this.makeUri(a)}};return g}(),a.define=function(b,c){var d;return"string"==$.type(b)?(d=a.Helper.Utility.getApplicationName(b),b=a.Helper.Utility.getComponentName(b),a.Component[d]=a.Component[d]||{},a.Component[d][b]=t(c),a.Component[d][b]):t(b)},$(document).ready(function(){q=!0,a.Core.Application.publish("DomReady"),void 0!=a.ready&&a.ready()}),a});
//# sourceMappingURL=transformers.min.map